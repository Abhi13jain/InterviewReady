<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="1400" viewBox="0 0 1000 1400">
  <style>
    .box { fill: #0f172a; stroke: #60a5fa; stroke-width: 2; rx: 8; }
    .sbox { fill: #071133; stroke: #7dd3fc; stroke-width: 1.5; rx: 6; }
    .text { fill: #e6f2ff; font-family: Inter, Arial, sans-serif; font-size: 14px; }
    .title { fill: #e6f2ff; font-weight: 700; font-size: 18px; }
    .note { fill: #9fbfdc; font-size: 12px; }
    .arrow { stroke: #7dd3fc; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#7dd3fc" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="50" y="40" class="title">InterviewReady — User Flow</text>
  <text x="50" y="65" class="note">Server = dark blue boxes; Client = lighter boxes. Arrows show direction of actions & data.</text>

  <!-- Start -->
  <rect x="50" y="90" width="320" height="56" class="box"/>
  <text x="70" y="125" class="text">Start / Landing</text>

  <!-- Auth row -->
  <rect x="50" y="180" width="320" height="64" class="sbox"/>
  <text x="70" y="210" class="text">Sign Up / Sign In (Firebase Client)</text>
  <text x="70" y="228" class="note">components/AuthForm.tsx</text>

  <!-- Dashboard -->
  <rect x="50" y="280" width="320" height="64" class="sbox"/>
  <text x="70" y="310" class="text">Dashboard (Server + Client)</text>
  <text x="70" y="328" class="note">app/(root)/page.tsx, InterviewCard</text>

  <!-- Generate Interview (client -> server) -->
  <rect x="50" y="380" width="420" height="72" class="box"/>
  <text x="70" y="415" class="text">Generate Interview Request (client)</text>
  <text x="70" y="433" class="note">API call -> app/api/vapi/generate/route.ts</text>

  <!-- Server AI generation -->
  <rect x="520" y="380" width="400" height="72" class="box"/>
  <text x="540" y="415" class="text">Server: Call LLM (Gemini)</text>
  <text x="540" y="433" class="note">generateText(...) — parse JSON questions & save to Firestore</text>

  <!-- DB -->
  <rect x="520" y="480" width="320" height="56" class="sbox"/>
  <text x="540" y="515" class="text">Firestore: interviews collection</text>

  <!-- Interview page -->
  <rect x="50" y="520" width="320" height="72" class="sbox"/>
  <text x="70" y="555" class="text">Open Interview Page</text>
  <text x="70" y="573" class="note">app/(root)/interview/[id]/page.tsx</text>

  <!-- Agent (client) -->
  <rect x="50" y="620" width="420" height="96" class="sbox"/>
  <text x="70" y="655" class="text">Agent (Client)
  </text>
  <text x="70" y="673" class="note">AgentWrapper -> dynamic Agent (components/Agent.tsx)</text>

  <!-- VAPI SDK init -->
  <rect x="520" y="620" width="400" height="72" class="box"/>
  <text x="540" y="655" class="text">VAPI Web SDK (client token)</text>
  <text x="540" y="673" class="note">lib/vapi.sdk.ts — NEXT_PUBLIC_VAPI_WEB_TOKEN</text>

  <!-- Voice session -->
  <rect x="520" y="720" width="400" height="80" class="sbox"/>
  <text x="540" y="755" class="text">Real-time Voice Session (STT/TTS)</text>
  <text x="540" y="774" class="note">vapi events: message, speech-start, speech-end</text>

  <!-- Transcripts to DB -->
  <rect x="50" y="760" width="420" height="64" class="box"/>
  <text x="70" y="795" class="text">Collect final transcripts (client)</text>
  <text x="70" y="813" class="note">Agent sends transcript -> createFeedback -> Firestore</text>

  <rect x="520" y="820" width="320" height="56" class="sbox"/>
  <text x="540" y="855" class="text">Firestore: feedback collection</text>

  <!-- Feedback page -->
  <rect x="50" y="900" width="320" height="64" class="sbox"/>
  <text x="70" y="935" class="text">View Feedback / Score</text>
  <text x="70" y="953" class="note">InterviewCard links to feedback page</text>

  <!-- arrows -->
  <path d="M210 146 L210 180" class="arrow" />
  <path d="M210 244 L210 280" class="arrow" />
  <path d="M210 344 L210 380" class="arrow" />
  <path d="M470 415 L520 415" class="arrow" />
  <path d="M680 452 L680 480" class="arrow" />
  <path d="M210 452 L210 520" class="arrow" />
  <path d="M470 656 L520 656" class="arrow" />
  <path d="M680 695 L680 720" class="arrow" />
  <path d="M470 760 L520 760" class="arrow" />
  <path d="M210 856 L210 900" class="arrow" />
  <path d="M390 736 L390 760" class="arrow" />

  <!-- side notes: env and server/client legend -->
  <rect x="50" y="1010" width="880" height="320" rx="8" fill="#020617" stroke="#1f2937"/>
  <text x="70" y="1040" class="title">Legend & Environment</text>
  <text x="70" y="1066" class="note">Server-side: `GOOGLE_GENERATIVE_AI_API_KEY`, `app/api/*` routes</text>
  <text x="70" y="1086" class="note">Client-side: `NEXT_PUBLIC_VAPI_WEB_TOKEN`, `NEXT_PUBLIC_FIREBASE_API_KEY`</text>
  <text x="70" y="1106" class="note">DB: Firestore stores `interviews` and `feedback` collections</text>
  <text x="70" y="1126" class="note">Flow highlights: keep secrets server-side, use short-lived client tokens for VAPI</text>

</svg>
